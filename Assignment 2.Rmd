---
title: "Assignment 2"
author: "Victor Asum"
date: "2024-11-21"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**Is the perception of media freedom associated with citizens' satisfaction with democracy in Ghana?**

*Explainatory Variable*: Perception of Media Freedom (Q33H)

*Response Variable*: Satisfaction of democracy (Q31)


**Does primary langauge used in interview influence the length of the interview?**

*Explanatory Variable*:  Language of interview (Q102)

*Response Variable*: Length of interview (LENGTH)


# SECTION 1:
```{r}
library(descr)
library(haven)
GH_AFRO_9 <- read_sav("C:/Users/AiAsum/Downloads/afrobarometer_release-dataset_gha_r9_en_2023-04-01.sav")

```


# Section 2: 
Sub
```{r}
vars <- c("Q33H", "Q31", "Q102", "LENGTH") 
cleanData <- GH_AFRO_9[vars]
save(cleanData, file='PA2_Research.RDATA')

```


# Section 2 b: Error handling and Labeling variable response categories

```{r}

# first research questions

# Perception of Media Freedom (Q33H)
cleanData$Q33H <- as.character(cleanData$Q33H)

cleanData$Q33H[cleanData$Q33H == "8"] <- NA
cleanData$Q33H[cleanData$Q33H == "9"] <- NA
cleanData$Q33H[cleanData$Q33H == "-1"] <- NA


# Satisfaction of democracy (Q31)
cleanData$Q31 <- as.character(cleanData$Q31)
cleanData$Q31[cleanData$Q31 == "8"] <- NA
cleanData$Q31[cleanData$Q31 == "9"] <- NA
cleanData$Q31[cleanData$Q31 == "-1"] <- NA



# Second research question
# Language of interview (Q102)
cleanData$Q102 <- as.character(cleanData$Q102)


summary(cleanData$LENGTH)
mean(cleanData$LENGTH, na.rm = TRUE)
sd(cleanData$LENGTH, na.rm = TRUE)




freq(cleanData$Q33H, cex.names=0.5, ylab = "Frequency", xlab = "Citizen's Perceive of Media freedom")
freq(cleanData$Q31, cex.names=0.5, ylab = "Frequency", xlab = "Citizen's Satisfaction of Democracy")

freq(cleanData$Q102, cex.names=0.5, ylab = "Frequency", xlab = "Language used in interview")
hist(cleanData$LENGTH, main="Histogram of interview length", xlab="interview length (minutes)", ylab="Frequency", col="#ff00ff")



```


# Section 3 - 
```{r}
# I'm Creating secondary variables for media and democracy
# I choose to combine Not at all free", "Not very free", as one,"Somewhat free", "Completely free"
cleanData$Q33H[cleanData$Q33H == "0"] <- "1"

# I choose to combine Not at all free", "Not very free", as one,"Somewhat free", "Completely free"
cleanData$Q31[cleanData$Q31 == "0"] <- "1"


# Second Research:
# Primary Language used for the research
cleanData$Q102 <- as.character(cleanData$Q102)
cleanData$Q102[cleanData$Q102 == "261"] <- "9995"
cleanData$Q102[cleanData$Q102 == "262"] <- "9995"
cleanData$Q102[cleanData$Q102 == "263"] <- "9995"
cleanData$Q102[cleanData$Q102 == "264"] <- "9995"


# Changing to understanable variables
 cleanData$Q33H <- factor(cleanData$Q33H,
                          levels = c("1", "2", "3"),
                          labels = c("Not free", "Somewhat free", "Completely free")
                          )

 cleanData$Q31 <- factor(cleanData$Q31,
                        levels = c("1", "2", "3", "4"),
                        labels = c("Not at all satisfied", 
                                    "Not very satisfied", "Fairly satisfied", 
                                    "Very satisfied"))
 
cleanData$Q102 <- factor(cleanData$Q102,
                          levels = c("1", "260", "9995"),
                          labels = c("English", "Twi", "Others"))

freq(cleanData$Q33H, cex.names=0.5, ylab = "Frequency", xlab = "Citizen's Perceive of Media freedom")
freq(cleanData$Q31, cex.names=0.5, ylab = "Frequency", xlab = "Citizen's Satisfaction of Democracy")

freq(cleanData$Q102, cex.names=0.5, ylab = "Frequency", xlab = "Language used in interview")
hist(cleanData$LENGTH, main = "Histogram of interview length", xlab = "interview length (minutes)")



```


# Section 4

```{r}
# First Research

mediaTable <- table(cleanData$Q31, cleanData$Q33H)
mediaTable_colProp <-prop.table(mediaTable, 2)
round(mediaTable_colProp, 3)


# Second research
tapply(cleanData$LENGTH, cleanData$Q102, mean, na.rm = TRUE)
tapply(cleanData$LENGTH, cleanData$Q102, sd, na.rm = TRUE) 
tapply(cleanData$LENGTH, cleanData$Q102, length)




```

# SECTION 4:
```{r}
colors1 <- c("#AA5486", "#47663B", "#E8ECD7", "#EED3B1")
colors2 <- c("#181C14", "#FC8F54", "#697565","#AA5486")

barplot(
  mediaTable_colProp, 
  beside = TRUE,                
  cex.names = 0.6,
  ylim = c(0, 0.5),
  col = colors2,  
  xlab = "Perception of Media Freedom", 
  ylab = "Proportion of Citizen"
)

legend(
  "top",   
  legend = rownames(mediaTable_colProp),
  fill = colors2,
  title = "Level Satisifaction",
  cex = 0.6
)


# Box and whiaker plot
boxplot(cleanData$LENGTH ~ factor(cleanData$Q102),
        names = levels(factor(cleanData$Q102)),
        main = "Distribution of Length of interview for each primary",
        xlab = "Primary language",
        ylab = "Length",
        ylim = c(0, max(cleanData$LENGTH, na.rm = TRUE) + 10),
        col = "lightblue"
)


```

## Summary 
Based on the summary and visualized data, there appears to be a significant relationship between the perception of media freedom and satisfaction with democracy in Ghana. Respondents who perceived the media as "Not free" demonstrated a higher proportion of dissatisfaction (e.g., around 36% reported "Not very satisfied") and a much lower proportion of satisfaction (e.g., approximately 13% reported being "Very satisfied").In contrast, as perceptions of media freedom increased (from "Somewhat free" to "Completely free"), satisfaction with democracy also increased. For instance, among those who viewed the media as "Completely free," about 33% reported being "Very satisfied," while dissatisfaction decreased to less than 13% for the "Not at all satisfied" category. With this trend I propose that as citizens perceive greater media freedom, their satisfaction with democracy tends to improve.

Based on the summary and visualized data, interview lengths varied slightly across primary languages, with Twi showing the highest average (72.52 minutes), followed by English (71.19 minutes) and Others (68.81 minutes). However, the "Others" category displayed significantly higher variability (SD = 43.81), compared to English (SD = 25.62) and Twi (SD = 25.22).While the majority of interviews were of similar duration, all categories exhibited outliers, particularly with longer interviews in the "Others" group. This variability may reflect differences in linguistic or contextual factors influencing interview length.


# Section 7
```{r}

 # Testing for first research

# Null Hypothesis: There is no association between the perception of media freedom and citizens' satisfaction with democracy in Ghana.

# Alternative Hypothesis: There is an association between the perception of media freedom and citizens' satisfaction with democracy in Ghana.

media_chisq_results <- chisq.test(cleanData$Q31, cleanData$Q33H)
media_chisq_results 


media_chisq_results$observed
media_chisq_results$expected
media_chisq_results$residuals

# I think since the p value is < 0.05, I need to conduct a Post Hoc test

# 1. Subset for Not Free and Somewhat Free
mySubset_0_1 <- subset(cleanData, Q33H == "Not free" | Q33H == "Somewhat free")

chisq_0_1 <- chisq.test(mySubset_0_1$Q31, mySubset_0_1$Q33H)
print(chisq_0_1)

# Subset for Not Free and Completely Free
mySubset_0_2 <- subset(cleanData, Q33H == "Not free" | Q33H == "Completely free")
chisq_0_2 <- chisq.test(mySubset_0_2$Q31, mySubset_0_2$Q33H)
print(chisq_0_2)

# Subset for Somewhat Free and Completely Free
mySubset_1_2 <- subset(cleanData, Q33H == "Somewhat free" | Q33H == "Completely free")
chisq_1_2 <- chisq.test(mySubset_1_2$Q31, mySubset_1_2$Q33H)
print(chisq_1_2)


# o avoid a Type I error (false positive)




```

